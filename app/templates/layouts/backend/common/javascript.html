<!-- jQuery  -->
<script src="{{ url_for('static', filename='backend/js/jquery.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/js/popper.min.js') }}"></script><!-- Popper for Bootstrap --><!-- Tether for Bootstrap -->
<script src="{{ url_for('static', filename='backend/js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/js/waves.js') }}"></script>
<script src="{{ url_for('static', filename='backend/js/jquery.slimscroll.js') }}"></script>
<script src="{{ url_for('static', filename='backend/js/jquery.scrollTo.min.js') }}"></script>

{% if data_mask %}
<script src="{{ url_for('static', filename='backend/plugins/bootstrap-inputmask/bootstrap-inputmask.min.js') }}" type="text/javascript"></script>
{% endif %}

{% if datatable %}
<!-- Required datatable js -->
<script src="{{ url_for('static', filename='backend/plugins/datatables/jquery.dataTables.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/dataTables.bootstrap4.min.js') }}"></script>
<!-- Buttons examples -->
<script src="{{ url_for('static', filename='backend/plugins/datatables/dataTables.buttons.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/buttons.bootstrap4.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/jszip.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/pdfmake.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/vfs_fonts.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/buttons.html5.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/buttons.print.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/buttons.colVis.min.js') }}"></script>
<!-- Responsive examples -->
<script src="{{ url_for('static', filename='backend/plugins/datatables/dataTables.responsive.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/datatables/responsive.bootstrap4.min.js') }}"></script>
{% endif %}

{% if wizard %}
<!--Form Wizard-->
<script src="{{ url_for('static', filename='backend/plugins/jquery.steps/js/jquery.steps.min.js') }}" type="text/javascript"></script>
<script type="text/javascript" src="{{ url_for('static', filename='backend/plugins/jquery-validation/js/jquery.validate.min.js') }}"></script>

<!--wizard initialization-->
<script src="{{ url_for('static', filename='backend/pages/jquery.wizard-init.js') }}" type="text/javascript"></script>

{% endif %}

{% if modal %}
<!-- Modal-Effect -->
<script src="{{ url_for('static', filename='backend/plugins/custombox/dist/custombox.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/plugins/custombox/dist/legacy.min.js') }}"></script>
{% endif %}

<!-- App js -->
<script src="{{ url_for('static', filename='backend/js/jquery.core.js') }}"></script>
<script src="{{ url_for('static', filename='backend/js/jquery.app.js') }}"></script>

{% if datatable %}
<script type="text/javascript">
    $(document).ready(function() {
        //$('.datatable').DataTable();

        //Buttons examples
        var table = $('.datatable').DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf']
        });

        table.buttons().container()
                .appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)');
    } );

</script>
{% endif %}

{% if map %}

<script>
  var map;
  function initMap() {
    {% if properties %}
    var markers = [];//some array
    var map = new google.maps.Map(document.getElementById('gmaps-marker'), {
      center: {lat: -34.397, lng: 150.644},
      maxZoom: 15
    });
    {% for property in properties %}
      {% if property.address.latitude is not none and property.address.longitude is not none %}
        markers.push(new google.maps.Marker({
          position: {lat: {{ property.address.latitude }}, lng: {{ property.address.longitude}} },
          map: map,
          title: '{{ property.address }}',
          url: '{{ url_for('deals.view', property_id=property.id) }}'
        }));
      {% endif %}
    {% endfor %}
    var bounds = new google.maps.LatLngBounds();
    for (var i = 0; i < markers.length; i++) {
     bounds.extend(markers[i].getPosition());
    }

    map.fitBounds(bounds);

    {% else %}
      {% if property and property.address.latitude is not none and property.address.longitude is not none %}
        var propertyLocation = {lat: {{ property.address.latitude}}, lng: {{ property.address.longitude}}};
        var map = new google.maps.Map(document.getElementById('gmaps-marker'), {
          center: propertyLocation,
          zoom: 8
        });
        var marker = new google.maps.Marker({
          position: propertyLocation,
          map: map,
          title: '{{ property.address }}',
          url: {{ url_for('deals.view', property_id=property.id) }}
        });
      {% endif %}
    {% endif %}
  }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBW06EkRn-nhTFtmqjiPsQN_1GBsI9Lh2Q&callback=initMap"
async defer></script>
{% endif %}

{% if sweetalert %}
<script src="{{ url_for('static', filename='backend/plugins/bootstrap-sweetalert/sweet-alert.min.js') }}"></script>
<script src="{{ url_for('static', filename='backend/pages/jquery.sweet-alert.init.js') }}"></script>
<script type=text/javascript>
  $(function() {
    $('.export-buyers').click(function() {
      var this_deal_id = $(this).attr('id')
      swal({
        title: "Send Export List?",
        text: "Press OK to email the export.",
        type: "info",
        showCancelButton: true,
        closeOnCancel: true,
        closeOnConfirm: false,
        showLoaderOnConfirm: true
      }, function (inputValue) {
        if(inputValue === false) return false;
        $.ajax({
            url: "#" + '?deal_id=' + this_deal_id,
            type: 'GET',
            success: function(response) {
                swal("Success!", "Your email has been sent. Please check your mailbox.", "success")
            },
            error: function(error) {
                swal("Uh Oh!", "Something went wrong and your email was not sent.", "warning")
            }
        });

      });
    });
  });
</script>
{% endif %}
